<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è–èª•è½‰ç›¤æŠ½ç</title>
    <style>
        :root {
            --christmas-red: #D32F2F;
            --christmas-green: #2E7D32;
            --christmas-gold: #FFD700;
            --bg-gradient: radial-gradient(circle, #8E0E00, #1F1C18);
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg-gradient);
            color: white;
            margin: 0;
            padding: 0;
            height: 100vh; /* ä½”æ»¿å…¨è¢å¹•é«˜åº¦ */
            width: 100vw;
            overflow: hidden; /* ç¦æ­¢æ²å‹• */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* ä¸»å®¹å™¨ï¼šè² è²¬æ’ç‰ˆ */
        .main-wrapper {
            display: flex;
            flex-direction: column; /* é è¨­ç›´å‘ */
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
        }

        h1 {
            color: var(--christmas-gold);
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            margin: 10px 0;
            font-size: 1.8rem;
            text-align: center;
        }

        /* è½‰ç›¤å®¹å™¨ */
        .game-container {
            position: relative;
            /* é—œéµï¼šä½¿ç”¨ vmin å–®ä½ï¼Œç¢ºä¿è½‰ç›¤æ°¸é ä¸æœƒè¶…å‡ºè¢å¹•çŸ­é‚Š */
            width: 80vmin; 
            height: 80vmin;
            max-width: 500px;
            max-height: 500px;
            margin: 10px auto;
            flex-shrink: 0; /* é˜²æ­¢è¢«æ“ å£“ */
        }

        #wheelCanvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3); /* é‡‘è‰²å…‰æšˆ */
            border: 8px solid #F8B400; /* é‡‘è‰²å¤–æ¡† */
            box-sizing: border-box;
        }

        /* æŒ‡é‡ */
        .pointer {
            position: absolute;
            top: -15%; /* æ ¹æ“šç›¸å°ä½ç½®èª¿æ•´ */
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
            width: 10vmin;
            height: 12vmin;
            background-image: url("data:image/svg+xml,%3Csvg width='40' height='50' viewBox='0 0 40 50' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M20 50L0 10C0 4.5 4.5 0 10 0H30C35.5 0 40 4.5 40 10L20 50Z' fill='%23FF3E3E' stroke='white' stroke-width='2'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-size: contain;
            filter: drop-shadow(0 4px 4px rgba(0,0,0,0.5));
        }

        /* æ§åˆ¶å€ */
        .controls {
            text-align: center;
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #spinBtn {
            background: linear-gradient(180deg, #FFD700, #FDB931);
            border: 2px solid #FFF;
            padding: 15px 50px;
            color: #8B0000;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 0 #B8860B, 0 10px 10px rgba(0,0,0,0.3);
            transition: transform 0.1s;
        }

        #spinBtn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #B8860B, 0 4px 4px rgba(0,0,0,0.3);
        }

        #spinBtn:disabled {
            background: #999;
            box-shadow: none;
            color: #555;
            cursor: not-allowed;
        }

        /* å…¨è¢å¹•æŒ‰éˆ• (å°å°çš„æ”¾åœ¨è§’è½æˆ–ä¸‹æ–¹) */
        .fullscreen-btn {
            background: transparent;
            border: 1px solid rgba(255,255,255,0.3);
            color: rgba(255,255,255,0.7);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            cursor: pointer;
        }

        /* --- æ©«å‘æ¨¡å¼ (Landscape) å°ˆç”¨ä½ˆå±€ --- */
        @media (orientation: landscape) {
            .main-wrapper {
                flex-direction: row; /* æ”¹ç‚ºå·¦å³æ’åˆ— */
                justify-content: space-evenly;
                gap: 20px;
            }

            .game-container {
                /* æ©«å‘æ™‚ï¼Œè½‰ç›¤ä½”æ“šé«˜åº¦çš„ 85% */
                width: 85vh;
                height: 85vh;
                margin: 0;
            }

            .info-panel {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                max-width: 300px;
            }
            
            h1 {
                font-size: 2.5rem;
                margin-bottom: 30px;
            }
        }

        /* çµæœå½ˆçª— */
        #resultModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 100;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #fff, #f0f0f0);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 80%;
            width: 400px;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.4);
            border: 4px solid #D32F2F;
            color: #333;
        }

        .prize-title {
            font-size: 1.8rem;
            color: #D32F2F;
            margin: 15px 0;
            font-weight: bold;
        }

        .prize-desc {
            font-size: 1.1rem;
            color: #555;
            margin-bottom: 25px;
            line-height: 1.6;
            white-space: pre-wrap;
        }

        .close-btn {
            background: #2E7D32;
            color: white;
            border: none;
            padding: 12px 40px;
            font-size: 1.2rem;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

    <div class="main-wrapper">
        
        <div class="game-container">
            <div class="pointer"></div>
            <canvas id="wheelCanvas" width="800" height="800"></canvas>
        </div>

        <div class="info-panel controls">
            <h1>ğŸ„ è–èª•å¥½é‹è½‰å‡ºä¾† ğŸ„</h1>
            <button id="spinBtn" onclick="spinWheel()">ç«‹å³é–‹è½‰</button>
            <br>
            <button class="fullscreen-btn" onclick="toggleFullScreen()">åˆ‡æ›å…¨è¢å¹•æ¨¡å¼</button>
        </div>
    </div>

    <div id="resultModal">
        <div class="modal-content">
            <h2>ğŸ‰ è–èª•å¿«æ¨‚ æ­å–œç²å¾— ğŸ‰</h2>
            <div class="prize-title" id="modalPrizeName"></div>
            <div class="prize-desc" id="modalPrizeDesc"></div>
            <button class="close-btn" onclick="closeModal()">é ˜å–ç¦®ç‰©</button>
        </div>
    </div>

    <script>
        // --- è¨­å®šå€ (å·²èª¿æ•´ç‚ºè–èª•é…è‰²èˆ‡æ–°æ©Ÿç‡) ---
        // color: èƒŒæ™¯è‰², textColor: æ–‡å­—è‰²
        const prizes = [
            { id: 1, text: "è²·ä¸€é€ä¸€", fullText: "å’–å•¡å„å“é …è²·ä¸€é€ä¸€", prob: 0.05, color: "#FBC02D", textColor: "#8B0000" }, // é‡‘è‰² (å¤§ç)
            { id: 2, text: "é‘°åŒ™åœˆ(åŠæ©‹)", fullText: "å…§ç£é™å®šå£“å…‹åŠ›é‘°åŒ™åœˆ(åŠæ©‹æ¬¾)", prob: 0.20, color: "#2E7D32", textColor: "#FFFFFF" }, // ç¶ è‰²
            { id: 3, text: "ç±³é¤…ä¸€ç‰‡", fullText: "ç±³é¤…ä¸€ç‰‡", prob: 0.30, color: "#C62828", textColor: "#FFFFFF" }, // ç´…è‰²
            { id: 4, text: "æ¿¾æ›å’–å•¡", fullText: "æ¿¾æ›å’–å•¡ä¸€åŒ…", prob: 0.15, color: "#2E7D32", textColor: "#FFFFFF" }, // ç¶ è‰²
            { id: 5, text: "ç¾å¼ä¸€æ¯", fullText: "ç¾å¼ä¸€æ¯", prob: 0.05, color: "#C62828", textColor: "#FFFFFF" }, // ç´…è‰²
            { id: 6, text: "é‘°åŒ™åœˆ(è»Šç«™)", fullText: "å…§ç£é™å®šå£“å…‹åŠ›é‘°åŒ™åœˆ(è»Šç«™æ¬¾)", prob: 0.21, color: "#2E7D32", textColor: "#FFFFFF" }, // ç¶ è‰²
            { id: 7, text: "æŠ˜æŠµé‡‘40", fullText: "æ–‡å‰µå•†å“æŠ˜æŠµé‡‘40å…ƒ(é™ç•¶æ—¥)", prob: 0.02, color: "#FBC02D", textColor: "#8B0000" }, // é‡‘è‰² (éŒ¢)
            { id: 8, text: "æŠ˜æŠµé‡‘50", fullText: "å…¨åº—å•†å“æŠ˜æŠµé‡‘50å…ƒ(ä¸é™é‡‘é¡)", prob: 0.02, color: "#C62828", textColor: "#FFFFFF" } // ç´…è‰² (æœ€å¤§çæ¦‚å¿µ)
        ];

        const totalProb = prizes.reduce((sum, item) => sum + item.prob, 0);

        const canvas = document.getElementById('wheelCanvas');
        const ctx = canvas.getContext('2d');
        const size = 800; // æé«˜è§£æåº¦è®“å¤§è¢å¹•çœ‹æ›´æ¸…æ™°
        const centerX = size / 2;
        const centerY = size / 2;
        const radius = size / 2 - 10; // ç•™é‚Šè·
        
        let currentRotation = 0;
        let isSpinning = false;
        const sliceAngle = 360 / prizes.length;

        // --- ç¹ªè£½è½‰ç›¤ (å„ªåŒ–ç‰ˆ) ---
        function drawWheel() {
            const startAngleOffset = -Math.PI / 2;

            prizes.forEach((prize, i) => {
                const startAngle = (i * sliceAngle) * (Math.PI / 180) + startAngleOffset;
                const endAngle = ((i + 1) * sliceAngle) * (Math.PI / 180) + startAngleOffset;

                // 1. ç•«æ‰‡å½¢
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.fillStyle = prize.color;
                ctx.fill();
                
                // ç•«æ‰‡å½¢é‚Šæ¡† (é‡‘è‰²ç·šæ¢)
                ctx.strokeStyle = "#F8B400";
                ctx.lineWidth = 2;
                ctx.stroke();

                // 2. ç•«æ–‡å­—
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(startAngle + (endAngle - startAngle) / 2);
                ctx.textAlign = "right";
                ctx.fillStyle = prize.textColor;
                ctx.font = "bold 36px 'Microsoft JhengHei', sans-serif"; // å­—é«”æ”¾å¤§
                
                // é™°å½±æå‡é–±è®€æ€§
                if(prize.textColor === "#FFFFFF") {
                    ctx.shadowColor = "rgba(0,0,0,0.3)";
                    ctx.shadowBlur = 4;
                }

                ctx.fillText(prize.text, radius - 60, 12);
                ctx.restore();
            });
        }

        // --- æŠ½çé‚è¼¯ ---
        function getPrizeIndex() {
            let random = Math.random() * totalProb;
            for (let i = 0; i < prizes.length; i++) {
                if (random < prizes[i].prob) return i;
                random -= prizes[i].prob;
            }
            return prizes.length - 1;
        }

        function spinWheel() {
            if (isSpinning) return;
            isSpinning = true;
            document.getElementById('spinBtn').disabled = true;

            const winningIndex = getPrizeIndex();
            const prizeCenterAngle = (winningIndex * sliceAngle) + (sliceAngle / 2);
            
            // Jitter
            const halfSlice = sliceAngle / 2;
            const safeZone = halfSlice * 0.8;
            const randomOffset = (Math.random() * 2 * safeZone) - safeZone;

            let targetAngleRelativeToZero = (360 - prizeCenterAngle) + randomOffset;
            while (targetAngleRelativeToZero < 0) targetAngleRelativeToZero += 360;

            const currentMod = currentRotation % 360;
            let distanceToTarget = targetAngleRelativeToZero - currentMod;
            if (distanceToTarget < 0) distanceToTarget += 360;

            const extraSpins = 360 * 8; // 8åœˆ
            const finalRotation = currentRotation + extraSpins + distanceToTarget;

            // 8ç§’ç·©æ…¢åœä¸‹
            canvas.style.transition = 'transform 8s cubic-bezier(0.1, 0.7, 0.1, 1)';
            canvas.style.transform = `rotate(${finalRotation}deg)`;
            
            currentRotation = finalRotation;

            setTimeout(() => {
                isSpinning = false;
                document.getElementById('spinBtn').disabled = false;
                showResult(prizes[winningIndex]);
            }, 8000);
        }

        function showResult(prize) {
            document.getElementById('modalPrizeName').innerText = prize.text;
            document.getElementById('modalPrizeDesc').innerText = prize.fullText;
            document.getElementById('resultModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('resultModal').style.display = 'none';
        }

        // å…¨è¢å¹•åŠŸèƒ½
        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    alert(`Error attempting to enable full-screen mode: ${err.message} (${err.name})`);
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        // åˆå§‹åŒ–
        drawWheel();

    </script>
</body>
</html>
